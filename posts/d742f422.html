<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>XCPC wiki - 质数与约数 | 小明の雜貨屋</title><meta name="author" content="小明同學"><meta name="copyright" content="小明同學"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="![[…&#x2F;data&#x2F;img&#x2F;e5e92bc7d32828b005d6b7f73694da57_720.jpg]]  素数筛 （欧拉筛） 1234567891011121314vector&lt;int&gt; prime;int mint[N];   &#x2F;&#x2F; 最小素因子 void init() &#123;    for (int i &#x3D; 2; i &lt; N; i++) &#123;"><meta property="og:type" content="article"><meta property="og:title" content="XCPC wiki - 质数与约数"><meta property="og:url" content="http://kobicgend.top/posts/d742f422.html"><meta property="og:site_name" content="小明の雜貨屋"><meta property="og:description" content="![[…&#x2F;data&#x2F;img&#x2F;e5e92bc7d32828b005d6b7f73694da57_720.jpg]]  素数筛 （欧拉筛） 1234567891011121314vector&lt;int&gt; prime;int mint[N];   &#x2F;&#x2F; 最小素因子 void init() &#123;    for (int i &#x3D; 2; i &lt; N; i++) &#123;"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="http://kobicgend.top/img/avatar.webp"><meta property="article:published_time" content="2025-01-24T14:05:00.000Z"><meta property="article:modified_time" content="2025-01-24T14:05:00.000Z"><meta property="article:author" content="小明同學"><meta property="article:tag" content="ACM"><meta property="article:tag" content="筆記"><meta property="article:tag" content="數學"><meta property="article:tag" content="算法"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://kobicgend.top/img/avatar.webp"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "XCPC wiki - 质数与约数",
  "url": "http://kobicgend.top/posts/d742f422.html",
  "image": "http://kobicgend.top/img/avatar.webp",
  "datePublished": "2025-01-24T14:05:00.000Z",
  "dateModified": "2025-01-24T14:05:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "小明同學",
      "url": "http://kobicgend.top/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.webp"><link rel="canonical" href="http://kobicgend.top/posts/d742f422.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const e={set:(e,t,o)=>{if(!o)return;const n=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:n}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:n}=JSON.parse(t);if(!(Date.now()>n))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise((o,n)=>{const a=document.createElement("script");a.src=e,a.async=!0,Object.entries(t).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||o()},a.onerror=n,document.head.appendChild(a)}),getCSS:(e,t)=>new Promise((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||o()},a.onerror=n,document.head.appendChild(a)}),addGlobalFn:(e,t,o=!1,n=window)=>{if(e.startsWith("pjax"))return;const a=n.globalFn||{};a[e]=a[e]||{},a[e][o||Object.keys(a[e]).length]=t,n.globalFn=a}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","undefined")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","undefined")};btf.activateDarkMode=t,btf.activateLightMode=o;const n=e.get("theme");"dark"===n?t():"light"===n&&o();const a=e.get("aside-status");void 0!==a&&document.documentElement.classList.toggle("hide-aside","hide"===a);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!1},copy:{success:"複製成功",error:"複製失敗",noSupport:"瀏覽器不支援"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"剛剛",min:"分鐘前",hour:"小時前",day:"天前",month:"個月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"載入更多"},isPhotoFigcaption:!1,islazyloadPlugin:!1,isAnchor:!0,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"XCPC wiki - 质数与约数",isHighlightShrink:!1,isToc:!0,pageType:"post"}</script><link rel="stylesheet" href="/css/transpancy.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/title.css"><link rel="stylesheet" href="/css/flipcountdown.css"><link rel="stylesheet" href="/css/masktag.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">載入中...</div></div></div><script>(()=>{const d=document.getElementById("loading-box"),e=document.body,o=()=>{e.style.overflow="",d.classList.add("loaded")},l=()=>{e.style.overflow="hidden",d.classList.remove("loaded")};l(),window.addEventListener("load",o)})()</script><div id="web_bg" style="background-image:url(/img/background.webp)"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">382</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">23</div></a></div><div class="menus_items"><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-book"></i> <span>記事簿</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/diary/diary-stz/"><i class="fa-fw fa fa-book"></i> <span>《中外历史纲要》</span></a></li><li><a class="site-page child" href="/categories/%E6%97%A5%E8%A8%98/%E4%B8%BB%E6%9C%BA%E8%A8%BB%E8%A8%98/"><i class="fa-fw fa fa-book"></i> <span>《主机註記》</span></a></li><li><a class="site-page child" href="/diary/hutaolinriji/"><i class="fa-fw fa fa-book"></i> <span>楜桃林日記</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-open"></i> <span>筆記本</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/935ec80a.html"><i class="fa-fw fa fa-quran"></i> <span>XCPC</span></a></li><li><a class="site-page child" href="/notes/"><i class="fa-fw fa fa-tanakh"></i> <span>大學筆記</span></a></li><li><a class="site-page child" href="/notes/"><i class="fa-fw fa fa-tanakh"></i> <span>其它筆記</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-palette"></i> <span>作品集</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E4%BD%9C%E5%93%81/%E5%BE%AE%E4%BF%A1%E5%85%AC%E7%9C%BE%E8%99%9F/"><i class="fa-fw fa fa-radio"></i> <span>CUC-Radio</span></a></li><li><a class="site-page child" href="/posts/e7eea71f.html"><i class="fa-fw fa fa-stamp"></i> <span>篆刻作品展</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-toolbox"></i> <span>工具箱</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Music/"><i class="fa-fw fa fa-music"></i> <span>Music</span></a></li><li><a class="site-page child" href="/categories/Poetry/"><i class="fa-fw fa fa-guitar"></i> <span>詩詞</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i> <span>更多</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/c096c313.html"><i class="fa-fw fa fa-subway"></i> <span>地鐵圖</span></a></li><li><a class="site-page child" href="/ovo/eikon"><span>賽博空調</span></a></li><li><a class="site-page child" href="/ovo/tabe"><span>中午吃什么</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>好盆友</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i> <span>關於小明</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/index.webp)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">小明の雜貨屋</span></a><a class="nav-page-title" href="/"><span class="site-name">XCPC wiki - 质数与约数</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-book"></i> <span>記事簿</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/diary/diary-stz/"><i class="fa-fw fa fa-book"></i> <span>《中外历史纲要》</span></a></li><li><a class="site-page child" href="/categories/%E6%97%A5%E8%A8%98/%E4%B8%BB%E6%9C%BA%E8%A8%BB%E8%A8%98/"><i class="fa-fw fa fa-book"></i> <span>《主机註記》</span></a></li><li><a class="site-page child" href="/diary/hutaolinriji/"><i class="fa-fw fa fa-book"></i> <span>楜桃林日記</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-open"></i> <span>筆記本</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/935ec80a.html"><i class="fa-fw fa fa-quran"></i> <span>XCPC</span></a></li><li><a class="site-page child" href="/notes/"><i class="fa-fw fa fa-tanakh"></i> <span>大學筆記</span></a></li><li><a class="site-page child" href="/notes/"><i class="fa-fw fa fa-tanakh"></i> <span>其它筆記</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-palette"></i> <span>作品集</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E4%BD%9C%E5%93%81/%E5%BE%AE%E4%BF%A1%E5%85%AC%E7%9C%BE%E8%99%9F/"><i class="fa-fw fa fa-radio"></i> <span>CUC-Radio</span></a></li><li><a class="site-page child" href="/posts/e7eea71f.html"><i class="fa-fw fa fa-stamp"></i> <span>篆刻作品展</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-toolbox"></i> <span>工具箱</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Music/"><i class="fa-fw fa fa-music"></i> <span>Music</span></a></li><li><a class="site-page child" href="/categories/Poetry/"><i class="fa-fw fa fa-guitar"></i> <span>詩詞</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i> <span>更多</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/c096c313.html"><i class="fa-fw fa fa-subway"></i> <span>地鐵圖</span></a></li><li><a class="site-page child" href="/ovo/eikon"><span>賽博空調</span></a></li><li><a class="site-page child" href="/ovo/tabe"><span>中午吃什么</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>好盆友</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i> <span>關於小明</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">XCPC wiki - 质数与约数</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2025-01-24T14:05:00.000Z" title="發表於 2025-01-24 22:05:00">2025-01-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2025-01-24T14:05:00.000Z" title="更新於 2025-01-24 22:05:00">2025-01-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AD%86%E8%A8%98/">筆記</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AD%86%E8%A8%98/XCPCwiki/">XCPCwiki</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">總字數:</span><span class="word-count">10.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">閱讀時間:</span><span>53分鐘</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">瀏覽量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>![[…/data/img/e5e92bc7d32828b005d6b7f73694da57_720.jpg]]</p><h1>素数筛 （欧拉筛）</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; prime;</span><br><span class="line"><span class="type">int</span> mint[N];   <span class="comment">// 最小素因子 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mint[i]) mint[i] = i, prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; p : prime) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1ll</span> * i * p &gt;= N) <span class="keyword">break</span>;</span><br><span class="line">            mint[i * p] = p;</span><br><span class="line">            <span class="keyword">if</span> (p == mint[i]) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mint[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度 $\Theta(n)$</p><h2 id="VJwin6D- 又见 GCD"><a target="_blank" rel="noopener" href="https://acm.hdu.edu.cn/showproblem.php?pid=2504">VJwin6D - 又见 GCD</a></h2><p><strong>题意</strong> 已知 $a,~b$，数 $c$ 满足 $\gcd(a,c)=b$ 且 $c\ne b$，求 $c$ 的最小值。</p><p><strong>思路</strong> 设 $a=ba_0,~c=bc_0$，则 $\gcd(a_0,c_0)=1$，对 $a_0$ 作惟一分解 $a_0=\prod p_i^{\alpha_i}$，取最小的满足 $p_0\nmid a$ 的 $p_0$，则 $c=bp_0$ 是所求的最小值。其中求 $p_0$ 可借助素数筛。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll a, c;</span><br><span class="line">    <span class="built_in">memset</span>(isFactor, <span class="number">0</span>, <span class="keyword">sizeof</span> isFactor);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;a, &amp;c);</span><br><span class="line">    a /= c;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= a; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a % i == <span class="number">0</span>) isFactor[i] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (a % i == <span class="number">0</span>) a /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= maxN; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isntPrime[i] &amp;&amp; !isFactor[i]) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, c * i);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>评注</strong> 枚举 $c=bi,~i\geqslant2$，直至 $(a,c)=b$ 即可。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;a, &amp;c);</span><br><span class="line">b = <span class="number">2</span> * c;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">gcd</span>(a, b) != c) b += c;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, b);</span><br></pre></td></tr></table></figure><h2 id="质数距离">质数距离</h2><h3 id="Description">Description</h3><p>给定两个整数 $L$ 和 $U$，你需要在闭区间 $[L,U]$ 内找到距离最接近的两个相邻质数 $C_1$ 和 $C_2$（$C_1 &lt; C_2$）（即 $C_2-C_1$ 是最小的），如果存在相同距离的其他相邻质数对，则输出第一对。</p><p>同时，你还需要找到距离最远的两个相邻质数 $D_1$ 和 $D_2$（$D_1 &lt; D_2$）（即 $D_2-D_1$ 是最大的），如果存在相同距离的其他相邻质数对，则输出第一对。</p><h4 id="输入格式">输入格式</h4><p>每行输入两个整数 $L$ 和 $U$，其中 $L$ 和 $U$ 的差值不会超过 $10^6$。</p><h4 id="输出格式">输出格式</h4><p>对于每个 $L$ 和 $U$，输出一个结果，结果占一行。</p><p>结果包括距离最近的相邻质数对和距离最远的相邻质数对。（具体格式参照样例）</p><p>如果 $L$ 和 $U$ 之间不存在质数对，则输出 <code>There are no adjacent primes.</code>。</p><h4 id="数据范围">数据范围</h4><p>$1 \le L &lt; U \le 2^{31}-1$</p><h3 id="Notes">Notes</h3><p>我们易知：对于每一个合数 $N$ 都有一个小于等于 $\sqrt{N}$ 的因子<br>所以，对于 $L\sim U$ 中的所有合数，一定有一个 $1\sim50000$ 的因子<br>因此，我们先利用素数筛找出所有 $1\sim50000$ 的所有素数，再通过这些素数筛掉所有 $L\sim U$ 中的所有合数</p><h3 id="Code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> ll N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> isntPrime[N];</span><br><span class="line"><span class="comment">// vector&lt;ll&gt; prime;</span></span><br><span class="line">ll prime[N];</span><br><span class="line">ll cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPrime</span><span class="params">(ll mx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= mx; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isntPrime[i])</span><br><span class="line">            prime[++cnt] = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll ps = prime[j];</span><br><span class="line">            <span class="keyword">if</span> (ps * i &gt; mx)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            isntPrime[ps * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % ps == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    isntPrime[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ps[N];</span><br><span class="line"><span class="comment">// ll st[N];</span></span><br><span class="line">ll st[(ll)<span class="number">1e6</span> + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">doPrime</span>(<span class="number">50000</span> + <span class="number">10</span>);</span><br><span class="line">    ll l, r;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;l, &amp;r))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= cnt; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll p1 = prime[j];</span><br><span class="line">            ll x = <span class="built_in">max</span>((l + (p1 - <span class="number">1</span>)) / p1 * p1, <span class="number">2ll</span> * p1);  <span class="comment">// l/p 向上取整再乘 p，表示大于等于 l 的第一个 p 的倍数 </span></span><br><span class="line">            <span class="keyword">for</span> (ll i = x; i &lt;= r; i += p1)</span><br><span class="line">            &#123;</span><br><span class="line">                st[i - l] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ll cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = l; i &lt;= r; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (st[i - l] == <span class="number">0</span> &amp;&amp; i &gt; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ps[++cnt] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cnt &lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;There are no adjacent primes.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ll D1, D2;</span><br><span class="line">        ll C1, C2;</span><br><span class="line">        ll valmin = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">        ll valmax = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt; cnt; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ps[i + <span class="number">1</span>] - ps[i] &lt; valmin)</span><br><span class="line">            &#123;</span><br><span class="line">                C1 = ps[i], C2 = ps[i + <span class="number">1</span>];</span><br><span class="line">                valmin = ps[i + <span class="number">1</span>] - ps[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ps[i + <span class="number">1</span>] - ps[i] &gt; valmax)</span><br><span class="line">            &#123;</span><br><span class="line">                D1 = ps[i], D2 = ps[i + <span class="number">1</span>];</span><br><span class="line">                valmax = ps[i + <span class="number">1</span>] - ps[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld,%lld are closest, %lld,%lld are most distant.\n&quot;</span>, C1, C2, D1, D2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="VJwin14F- 终于结束的起点"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4994">VJwin14F - 终于结束的起点</a></h2><p><strong>题意</strong> 给定模 $M$，设斐波那契数列取模后为 $\mathrm{fib}(n)$，求最小的 $n &gt; 0$，使得 $\mathrm{fib}(n)=0,~ \mathrm{fib}(n + 1)=1$。数据范围：$2 \leqslant M \leqslant 10^{18}$。</p><p><strong>思路</strong> 设 $n=f(M)$，</p><p>暴力打表：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> f1 = <span class="number">0</span>, f2 = <span class="number">1</span>, f3;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; INF; i++) &#123;</span><br><span class="line">    f3 = (f1 + f2) % M, f1 = f2, f2 = f3;</span><br><span class="line">    <span class="keyword">if</span> (f1 == <span class="number">0</span> &amp;&amp; f2 == <span class="number">1</span>) <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果为：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="number">1</span>     <span class="number">2</span> <span class="number">3</span>     <span class="number">3</span> <span class="number">8</span>     <span class="number">4</span> <span class="number">6</span>     <span class="number">5</span> <span class="number">20</span></span><br><span class="line"> <span class="number">6</span> <span class="number">24</span>    <span class="number">7</span> <span class="number">16</span>    <span class="number">8</span> <span class="number">12</span>    <span class="number">9</span> <span class="number">24</span>   <span class="number">10</span> <span class="number">60</span></span><br><span class="line"><span class="number">11</span> <span class="number">10</span>   <span class="number">12</span> <span class="number">24</span>   <span class="number">13</span> <span class="number">28</span>   <span class="number">14</span> <span class="number">48</span>   <span class="number">15</span> <span class="number">40</span></span><br><span class="line"><span class="number">16</span> <span class="number">24</span>   <span class="number">17</span> <span class="number">36</span>   <span class="number">18</span> <span class="number">24</span>   <span class="number">19</span> <span class="number">18</span>   <span class="number">20</span> <span class="number">60</span></span><br><span class="line"><span class="number">21</span> <span class="number">16</span>   <span class="number">22</span> <span class="number">30</span>   <span class="number">23</span> <span class="number">48</span>   <span class="number">24</span> <span class="number">24</span>   <span class="number">25</span> <span class="number">100</span></span><br><span class="line"><span class="number">26</span> <span class="number">84</span>   <span class="number">27</span> <span class="number">72</span>   <span class="number">28</span> <span class="number">48</span>   <span class="number">29</span> <span class="number">14</span>   <span class="number">30</span> <span class="number">120</span></span><br><span class="line"><span class="number">31</span> <span class="number">30</span>   <span class="number">32</span> <span class="number">48</span>   <span class="number">33</span> <span class="number">40</span>   <span class="number">34</span> <span class="number">36</span>   <span class="number">35</span> <span class="number">80</span></span><br><span class="line"><span class="number">36</span> <span class="number">24</span>   <span class="number">37</span> <span class="number">76</span>   <span class="number">38</span> <span class="number">18</span>   <span class="number">39</span> <span class="number">56</span>   <span class="number">40</span> <span class="number">60</span></span><br><span class="line"><span class="number">41</span> <span class="number">40</span>   <span class="number">42</span> <span class="number">48</span>   <span class="number">43</span> <span class="number">88</span>   <span class="number">44</span> <span class="number">30</span>   <span class="number">45</span> <span class="number">120</span></span><br><span class="line"><span class="number">46</span> <span class="number">48</span>   <span class="number">47</span> <span class="number">32</span>   <span class="number">48</span> <span class="number">24</span>   <span class="number">49</span> <span class="number">112</span>  <span class="number">50</span> <span class="number">300</span></span><br></pre></td></tr></table></figure><p>观察得出：</p><ul><li>$f(x^2)=xf(x)$，$f(x^n)=x^{n-1}f(x)$；</li><li>若 $p,q$ 为素数，则 $f(pq)=f(p)f(q)$，$f(p^mq^n)=\mathrm{lcm}\big[f(p^m),~f(q^n)\big]$；</li></ul><p>因此，设 $M=p_1^{\alpha_1}p_2^{\alpha_2}\dots p_n^{\alpha_n}$​，则<br>$$<br>\begin{align}</p><p>f(M)</p><p>&amp;=\mathrm{lcm}\big[<br>f(p_1^{\alpha_1}),~<br>f(p_2^{\alpha_2}),~\dots,~<br>f(p_n^{\alpha_n})\big] \</p><p>&amp;=\mathrm{lcm}\big[<br>p_1^{\alpha_1-1}f(p_1),~<br>p_2^{\alpha_2-1}f(p_2),~\dots,~<br>p_n^{\alpha_n-1}f(p_n)\big]</p><p>\end{align}<br>$$<br>便可求出结果。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">intread</span>(M);</span><br><span class="line"><span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">2</span>; p &lt;= M; ++p) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!(M % p)) &#123;</span><br><span class="line">        <span class="type">int</span> times = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!(M % p)) ++times, M /= p;</span><br><span class="line">        ans = <span class="built_in">lcm</span>(ans, <span class="built_in">solve</span>(p) * <span class="built_in">qpow</span>(p, times - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure><p>其中 <code>solve()</code> 函数就是刚才的暴力打表函数，其复杂度不确定，最坏情况是 $\Theta(M^2)$。</p><blockquote><p>输入 <code>1000000009</code>，程序运行 <code>4.25s</code>，超时。</p></blockquote><p>对于很大的素数，时间复杂度可能很大，仍需优化。</p><p><strong>优化</strong> 首先寻找 $\mathrm{fib}(n)=0$，设 $t=\mathrm{fib}(n+1)$，那么只需找到最小的 $m$，使得 $t^m \equiv 1$，答案即是 $mn$。</p><p>证明：熟知，由于 $\mathrm{fib}(n)=0$，那么 $\mathrm{fib}(mn)=0$，由于 $t=\mathrm{fib}(n+1)$，那么 $\mathrm{fib}(2n+1)=t^2$，$\mathrm{fib}(mn+1)=t^m$，因此满足 $t^m \equiv 1$ 的 $m$ 即是所求。</p><p>时间复杂度最坏情况是 $\Theta(M)$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> f1 = <span class="number">0</span>, f2 = <span class="number">1</span>, f3;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; ; i++) &#123;</span><br><span class="line">    f3 = (f1 + f2) % M, f1 = f2, f2 = f3;</span><br><span class="line">    <span class="keyword">if</span> (f1 == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f2 == <span class="number">1</span>) <span class="keyword">return</span> i;</span><br><span class="line">        ll t = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; ; ++j) &#123;</span><br><span class="line">            t = (t * f2) % M;</span><br><span class="line">            <span class="keyword">if</span> (t % M == <span class="number">1</span>) <span class="keyword">return</span> i * j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>输入 <code>1000000009</code>，程序运行 <code>1.45s</code>……</p></blockquote><h1>勒让德定理</h1><h2 id="VJwin6H- 阶乘之乘"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2388">VJwin6H - 阶乘之乘</a></h2><p><strong>题意</strong> 求 $M=1!\times 2!\times 3!\times 4!\times \cdots \times n!$ 的末尾的 $0$ 的个数。</p><p><strong>思路</strong> 由于 $M$ 的标准分解中 $2$ 出现的次数一定多于 $5$，只需求由 $5$ 在 $M$ 中的指数。</p><blockquote><p><strong>勒让德定理</strong> ：在 $n!$ 中素数 $p$ 的指数<br>$$<br>v_p(n!)=\displaystyle\sum\limits_{k=1}^{p^k\le n}\bigg\lfloor\dfrac{n}{p^k}\bigg \rfloor=\dfrac{n-S_p(n)}{p-1}.<br>$$<br>其中，$S_p(n)$ 表示 $n$ 在 $p$ 进制下各个位数的和，熟知<br>$$<br>S_p(n)=</p><p>\begin{cases}</p><p>1, &amp; \text {if} n=1 \</p><p>\displaystyle S_p\Big(\frac{n}{p}\Big), &amp; \text {if} p\mid n \</p><p>S_p(n-1)+1, &amp; \text {otherwise}.</p><p>\end{cases}<br>$$</p></blockquote><p><strong>思路一</strong> 利用勒让德定理的第二个形式，打表计算 $S_p(n)$：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ll ans = <span class="number">1</span>;</span><br><span class="line">vector&lt;ll&gt; a;</span><br><span class="line">a.<span class="built_in">push_back</span>(<span class="number">0ll</span>); a.<span class="built_in">push_back</span>(<span class="number">1ll</span>);</span><br><span class="line"><span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">5</span>) a.<span class="built_in">push_back</span>(a[i - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> a.<span class="built_in">push_back</span>(a[i / <span class="number">5</span>]);</span><br><span class="line">    ans += a[i];</span><br><span class="line">&#125;</span><br><span class="line">ans = (n * (n + <span class="number">1</span>) / <span class="number">2</span> - ans) / <span class="number">4</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure><p>喜提 $\mathbf{MLE}$，改成 <code>map</code> 报 $\rm{TLE}$…… <code>1e8</code> 的数据真的很难处理。</p><p><strong>思路二</strong> 利用勒让德定理的第一个形式，稍作变形：<br>$$<br>\begin{align}</p><p>{\rm ans}<br>&amp;= \sum_{i=1}^{n}v_5(i!)<br>= \sum_{i=1}^{n}\sum_{k=1}^{5^k\le i}\bigg\lfloor\dfrac{i}{5^k}\bigg\rfloor<br>= \sum_{k=1}^{5^k\le n}\sum_{i=1}^{n}\bigg\lfloor\dfrac{i}{5^k}\bigg\rfloor \</p><p>&amp;= \sum_{k=1}^{5^k\le n}\bigg[<br>5^k<br>+2\cdot5^k<br>+\dots<br>+\bigg(\bigg\lfloor\dfrac{n}{5^k}\bigg\rfloor-1\bigg)\cdot5^k<br>+\bigg\lfloor\dfrac{n}{5^k}\bigg\rfloor\Big(n\bmod{5^k}+1\Big)<br>\bigg] \</p><p>&amp;= \sum_{k=1}^{5^k\le n}\bigg[<br>\frac{5^k}{2}\bigg\lfloor\dfrac{n}{5^k}\bigg\rfloor\bigg(\bigg\lfloor\dfrac{n}{5^k}\bigg\rfloor-1\bigg)<br>+\bigg\lfloor\dfrac{n}{5^k}\bigg\rfloor\Big(n\bmod{5^k}+1\Big)<br>\bigg] \</p><p>&amp;= \sum_{5\le i=5^k\le n}^{}\bigg[<br>\frac{i}{2}\bigg\lfloor\dfrac{n}{i}\bigg\rfloor\bigg(\bigg\lfloor\dfrac{n}{i}\bigg\rfloor-1\bigg)<br>+\bigg\lfloor\dfrac{n}{i}\bigg\rfloor\Big(n\bmod{i}+1\Big)<br>\bigg] \</p><p>\end{align}<br>$$</p><p>时间复杂度 $\Theta(\log n)$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">5</span>; i &lt;= n; i *= <span class="number">5</span>) &#123;</span><br><span class="line">    ans += (ll)i * (n / i) * (n / i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ans += (n / i) * (n % i + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure><h1>质因数分解</h1><p>算术基本定理：任何一个大于 $1$ 的正整数都能唯一分解为有限个质数的乘积<br>$$<br>N = p_{1}^{c_{1}}p_{2}^{c_{2}}\dots p_{m}^{c_{m}}<br>$$<br>推论 1：$N$ 的正约数的个数为<br>$$<br>\prod_{i=1}^{m}(c_{i}+1)=(c_{1}+1)(c_{2}+1)\cdots(c_{m}+1)<br>$$<br>推论 2：$N$ 的所有正约数的和为<br>$$<br>(1+p_{1}+p_{1}^{2}+\dots+p_{1}^{c_{1}})\cdots(1+p_{m}+p_{m}^{2}+\dots+p_{m}^{c_{m}})<br>$$<br>质数定理：$1\sim n$ 中的质数个数约为 $\cfrac{n}{\ln(n)}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 质因数分解 </span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">getfactor</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    vector&lt;array&lt;<span class="type">int</span>, 2&gt;&gt; res;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">                x /= i;</span><br><span class="line">                cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="built_in">push_back</span>(&#123; i, cnt &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) res.<span class="built_in">push_back</span>(&#123; x, <span class="number">1</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">move</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举约数 </span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">getdivisor</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> factor = <span class="built_in">getfactor</span>(x);</span><br><span class="line">    vector&lt;array&lt;<span class="type">int</span>, 2&gt;&gt; res;</span><br><span class="line">    <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">this</span> <span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> x, <span class="type">int</span> sum, <span class="type">int</span> id) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == factor.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(&#123; x, sum &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= factor[id][<span class="number">1</span>]; i++) &#123;</span><br><span class="line">            <span class="built_in">self</span>(x, sum + i, id + <span class="number">1</span>);</span><br><span class="line">            x *= factor[id][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sort</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">move</span>(res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度：$O(\sqrt{ N})$</p><p>用素数筛预处理</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> isntPrime[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; prime;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPrime</span><span class="params">(<span class="type">int</span> mx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= mx; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isntPrime[i])</span><br><span class="line">            prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p : prime)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p * i &gt; mx)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            isntPrime[p * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    isntPrime[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="type">int</span> m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; n &lt;&lt; <span class="string">&quot; = &quot;</span>;</span><br><span class="line">    m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> ps : prime)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ps * ps &gt; n)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (n % ps == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            p[++m] = ps, c[m] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n % ps == <span class="number">0</span>)</span><br><span class="line">                n /= ps, c[m]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p[++m] = n;</span><br><span class="line">        c[m] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; p[i] &lt;&lt; <span class="string">&quot;^&quot;</span> &lt;&lt; c[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不算欧拉筛的处理，时间复杂度 $O(\cfrac{2\sqrt{ N}}{\ln n})$</p><h2 id="BUC1B- 三角形数"><a target="_blank" rel="noopener" href="https://buctcoder.com/problem.php?cid=3377&amp;pid=1">BUC1B 三角形数</a></h2><p><strong>题意</strong> 求第一个约数数量大于 $500$ 的三角形数。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">numOfDivisors</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++) &#123;</span><br><span class="line">        <span class="type">int</span> r = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x % i == <span class="number">0</span>) ++r, x /= i;</span><br><span class="line">        <span class="keyword">if</span> (r) ans *= r + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ans *= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; ; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">numOfDivisors</span>(p) &gt; <span class="number">500</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, p);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p += i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>答案</strong> 76576500，约 19ms。</p><h1>枚举一个数的约数</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;ll&gt; <span class="title">factor</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    vector&lt;ll&gt; d;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i * i &lt;= x; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i) <span class="keyword">continue</span>;</span><br><span class="line">        d.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (i != x / i) d.<span class="built_in">push_back</span>(x / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="VJwin6J-Sumdiv"><a target="_blank" rel="noopener" href="http://poj.org/problem?id=1845">VJwin6J - Sumdiv</a></h2><p>（模板）求 $a^{b}$ 的因子和：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> MOD = <span class="number">9901</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll S = <span class="number">0</span>, C = <span class="number">0</span>; <span class="type">char</span> Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &gt; <span class="number">57</span> || Y &lt; <span class="number">48</span>) C |= Y == <span class="number">45</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &lt;= <span class="number">57</span> &amp;&amp; Y &gt;= <span class="number">48</span>) S = (S &lt;&lt; <span class="number">3</span>) + (S &lt;&lt; <span class="number">1</span>) + Y - <span class="number">48</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> C ? -S : S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans = ans * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qq</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">return</span> (<span class="built_in">qq</span>(a, n - <span class="number">1</span>) + <span class="built_in">qpow</span>(a, n - <span class="number">1</span>)) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">qq</span>(a, n / <span class="number">2</span>) * (<span class="built_in">qpow</span>(a, n / <span class="number">2</span>) + <span class="number">1</span>) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll a = <span class="built_in">read</span>(), b = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        ll ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= a; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a % i) <span class="keyword">continue</span>;</span><br><span class="line">            ll cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (a % i == <span class="number">0</span>) &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                a /= i;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = ans * <span class="built_in">qq</span>(i % MOD, (cnt * b + <span class="number">1</span>)) % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2024- 杭电多校 -8007-cats- 的 -k-xor">2024 杭电多校 8007 - cats 的 k-xor</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll S = <span class="number">0</span>, C = <span class="number">0</span>; <span class="type">char</span> Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &gt; <span class="number">57</span> || Y &lt; <span class="number">48</span>) C |= Y == <span class="number">45</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &lt;= <span class="number">57</span> &amp;&amp; Y &gt;= <span class="number">48</span>) S = (S &lt;&lt; <span class="number">3</span>) + (S &lt;&lt; <span class="number">1</span>) + Y - <span class="number">48</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> C ? -S : S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="built_in">read</span>(), b = <span class="built_in">read</span>(), c = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> v = a + b - c;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (v &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v == <span class="number">0</span>) &#123;</span><br><span class="line">        ans = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">auto</span> solve = [&amp;](<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> x) &#123;</span><br><span class="line">            <span class="keyword">while</span> (a || b || c) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((a % x + b % x) % x != c % x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                a /= x, b /= x, c /= x;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; <span class="number">1ll</span> * i * i &lt;= v; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v % i == <span class="number">0</span>) &#123;</span><br><span class="line">                ans += <span class="built_in">solve</span>(a, b, c, i);</span><br><span class="line">                <span class="keyword">if</span> (i != v / i) ans += <span class="built_in">solve</span>(a, b, c, v / i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (v &gt; <span class="number">1</span>) ans += <span class="built_in">solve</span>(a, b, c, v);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> T = <span class="built_in">read</span>(); T--; <span class="built_in">eachT</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="VJwin6F-Revenge-of-GCD"><a target="_blank" rel="noopener" href="https://acm.hdu.edu.cn/showproblem.php?pid=5019">VJwin6F - Revenge of GCD</a></h2><p><strong>题意</strong> 求两个数的第 $k$ 大公约数。</p><p><strong>思路</strong> 即是它们最大公约数的第 $k$ 大约数。枚举所有约数，再排序即可。</p><h2 id="VJwin6E-GCD-Arrays"><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1629/B">VJwin6E - GCD Arrays</a></h2><p><strong>题意</strong> 一个由连续正整数组成的数列 $A={l,~l+1,~\dots,~r}$，至多有 $k$ 次机会将两个数以它们的乘积替代，能否使 $\gcd A\ne1$。</p><p><strong>思路</strong> 记数列的项数为 $n$。</p><p>当 $n$ 为偶数时，一方面，$A$ 中不能有相邻两个自然数，故至少要操作 $\frac{n}{2}$ 次；另一方面，操作相邻两个奇数和偶数，共需 $\frac{n}{2}$ 次，此时 $\gcd A=2$。</p><p>当 $n$ 为奇数时，同样地，至少操作 $\frac{n-1}{2}$ 次，若 $l,r$ 都是偶数，操作后全是偶数，此时 $\gcd A=2$，但若 $l,r$ 都是奇数，操作后至少留下一个奇数，$\gcd A=1$，需要再操作一次。</p><h2 id="VJwin14B-Hankson- 的趣味题"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1072">VJwin14B - Hankson 的趣味题</a></h2><p><strong>题意</strong> 已知 $\gcd(x,a_0)=a_1,~\mathrm{lcm}(x,b_0)=b_1$，求满足条件的 $x$ 的个数。</p><p><strong>思路</strong> 考虑每一个素数 $p$，设 $p^{\gamma}\parallel x,~p^{\alpha_0}\parallel a_0,~p^{\alpha_1}\parallel a_1,~p^{\beta_0}\parallel b_0,~p^{\beta_1}\parallel b_1$，题设等价于 $\min(\gamma,\alpha_0)=\alpha_1,~\max(\gamma,\beta_0)=\beta_1$。</p><p>为了知道 $\gamma$ 的存在性，我们对四个字母作讨论：</p><p>如果 $\alpha_0&gt;\alpha_1\land \beta_0&lt;\beta_1$，则 $\gamma$ 存在 $\iff\alpha_1=\beta_1$，且只能取 $\gamma=\alpha_1$；</p><p>如果 $\alpha_0&gt;\alpha_1\land \beta_0=\beta_1$，则 $\gamma$ 存在 $\iff\alpha_1\leqslant\beta_1$，且只能取 $\gamma=\alpha_1$；</p><p>如果 $\alpha_0=\alpha_1\land \beta_0&lt;\beta_1$，则 $\gamma$ 存在 $\iff\alpha_1\leqslant\beta_1$，且只能取 $\gamma=\beta_1$；</p><p>如果 $\alpha_0=\alpha_1\land \beta_0=\beta_1$，则 $\gamma$ 存在 $\iff\alpha_1\leqslant\beta_1$，且 $\gamma$ 可以取 $[\alpha_1,\beta_1]$ 中任意整数，共 $\beta_1-\alpha_1+1$ 种选择。</p><p>考虑所有的素数 $p$，利用乘法原理即得答案。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> pa0 = <span class="number">0</span>, pa1 = <span class="number">0</span>, pb0 = <span class="number">0</span>, pb1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!(a0 % p)) ++pa0, a0 /= p;</span><br><span class="line">    <span class="keyword">while</span> (!(a1 % p)) ++pa1, a1 /= p;</span><br><span class="line">    <span class="keyword">while</span> (!(b0 % p)) ++pb0, b0 /= p;</span><br><span class="line">    <span class="keyword">while</span> (!(b1 % p)) ++pb1, b1 /= p;</span><br><span class="line">    <span class="keyword">if</span> (pa0 &gt; pa1 &amp;&amp; pb0 &lt; pb1) ans *= pa1 == pb1;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (pa0 &gt; pa1 &amp;&amp; pb0 == pb1) ans *= pa1 &lt;= pb1;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (pa0 == pa1 &amp;&amp; pb0 &lt; pb1) ans *= pa1 &lt;= pb1;</span><br><span class="line">    <span class="keyword">else</span> ans *= (pa1 &lt;= pb1) * (pb1 - pa1 + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有一个问题是素数 $p$ 的选择，我们使用素数筛找出在范围内的素数。注意，筛素数时只需筛出 $\leqslant\sqrt{\rm maxN}$ 的素数，以减小时间复杂度，但仍需考虑所给本身是个大素数的情形，因此在自除后，如果仍有 $a_0’&gt;1\lor b_1’&gt;1$，就说明它本身是个大素数，需要取 $p=a_0’$（或 $b_1’$）重複上述过程。</p><p>因此主函数的写法是：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a0, &amp;a1, &amp;b0, &amp;b1);</span><br><span class="line">ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cntPrime; i++) <span class="built_in">solve</span>(prime[i]);</span><br><span class="line"><span class="keyword">if</span> (a0 &gt; <span class="number">1</span>) <span class="built_in">solve</span>(a0);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (b1 &gt; <span class="number">1</span>) <span class="built_in">solve</span>(b1);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure><p><strong>评注</strong> 根据 $\gcd(x,a_0)=a_1,~\mathrm{lcm}(x,b_0)=b_1$，设 $x=x’a_1,~a_0=a_0’a_1,~b_1=x’‘x,~b_1=b_0’b_0$，有 $b_1=a_1x’x’‘$，再令 $n=x’x’‘$，即 $x’‘=\frac{n}{x’}$，则 $(x’,a_0’)=1,~(\frac{n}{x’},b_0’)=1$（结论一）</p><p>我们枚举 $n$ 的约数 $x_1$，带入检验 $(x’,a_0’)=1$ 是否成立，复杂度为 $\Theta(b_0’\sqrt n\log n)$。</p><p><strong>优化</strong> 因为 $(\frac{n}{x’},b_0’)=1$，故 $\frac{n}{x’}$ 与 $b_0’$ 没有相同的素因子，将 $n$ 与 $b_0’$ 所有相同的素因子从 $n$ 中去掉，得到 $n’$，能够证明，$\frac{n}{x’}\mid n’$，它等价于 $\frac{n}{n’}\mid x’$，</p><p>可设 $x’=\frac{n}{n’}r$，结合 $(x’,a_0’)=1$，知而 $r$ 也必须是 $n’$ 的约数。于是就又有：</p><p>$r|n’,(r,a_0’)=1$（结论二）</p><p>我们可以用与解决结论一相似的方法，将 $n’$ 与 $n$ 所有相同的质因数从 $n’$ 中去掉，得到剩余的数 $q$。那么这样，所有符合条件的 $r$ 都是 $q$ 的因数了。然后，我们可以用枚举 $q$ 的所有因数，输出 $q $ 的因数个数就行了。这样，复杂度便降到了：O((lqrn( $n’$)+log($n’$))*t)，从理论来说也不会超时了。</p><p>还有一点需要注意，那就是特判没有符合要求的 x 的情况。这种情况出现只有四种可能：</p><p>1、 $n’$ 不为整数</p><p>2、a_0’不为整数</p><p>3、b_0’不为整数</p><p>4、($\frac{n}{n’}$ ,s)≠1，即因为 $x’$ 是 l/l 的倍数，所以无论 r 取何值，都会有 (m,s)≠1</p><p>加上这四个特判，这道题便做完了。</p><p>代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">removeCommonP</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= b; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(b % i)) <span class="keyword">while</span> (!(a % i)) a /= i;</span><br><span class="line">        <span class="keyword">while</span> (!(b % i)) b /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (b != <span class="number">1</span>) <span class="keyword">while</span> (!(a % b)) a /= b;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125; <span class="comment">// 去掉 a 中与 b 共有的素因子 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a0, a1, b0, b1;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a0, &amp;a1, &amp;b0, &amp;b1);</span><br><span class="line">    <span class="keyword">if</span> (a0 % a1 || b1 % b0 || b1 % a1) &#123;<span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);<span class="keyword">return</span>;&#125;</span><br><span class="line">    a0 = a0 / a1, b0 = b1 / b0, a1 = b1 / a1;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="built_in">removeCommonP</span>(a1, b0);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">gcd</span>(a1 / n1, a0) != <span class="number">1</span>) &#123;<span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="type">int</span> n2 = <span class="built_in">removeCommonP</span>(n1, a0);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">numOfDivisors</span>(n2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CF919C-Partitioning-the-Array"><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1920/problem/C">CF919C. Partitioning the Array</a></h2><p><strong>题意</strong> 给出一个数列，将数量按序划分为长度均为 $k$ 的子列，且在某个模 $m$ 下所有子列全相等（定义为对应位置相等），求划分的种数。</p><p><strong>思路</strong> 有两个数需要确定：</p><p>一是子列长度 $k$。它是总元素个数的约数，容易枚举：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i * i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i * i == n) ans += <span class="built_in">sol</span>(i);</span><br><span class="line">        <span class="keyword">else</span> ans += <span class="built_in">sol</span>(i) + <span class="built_in">sol</span>(n / i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>二是模 $m$。这里介绍一种确定模的方法：</p><p>对于模 $m$，在模 $m$ 下所有子列对应位置全相等，即<br>$$<br>\begin{aligned}<br>a_1=a_{k+1}=a_{2k+1}=\cdots \pmod m \<br>a_2=a_{k+2}=a_{2k+2}=\cdots \pmod m \<br>\cdots\cdots \<br>a_k=~~~a_{2k}=~~~a_{3k}=\cdots \pmod m<br>\end{aligned}<br>$$<br>先从简单的情况入手，如果 $a=b\pmod m$，会得出什么？比如有模的定义式 $m \mid b-a$，我们根据 $a-b$ 枚举就能确定 $m$；</p><p>那三个数 $a=b=c\pmod m$ 呢？我们有 $m \mid b-a$ 和 $m \mid c-b$，这表明，$m \mid \gcd(b-a,~ c-b)$（公约数是最大公约数的约数）；</p><p>以此类推，推广到很多数的情形，根据第一行的式子，能够得到<br>$$<br>m \mid\gcd(a_{k+1}-a_1,~a_{2k+1}-a_{k+1},~\dots),<br>$$<br>进而，结合其它几行，<br>$$<br>m \mid\gcd(a_{k+1}-a_1,~a_{2k+1}-a_{k+1},~\dots,~a_{k+2}-a_2,~a_{2k+2}-a_{k+2},~\dots,~\dots),<br>$$<br>整理一下便是<br>$$<br>m \mid\gcd(a_{k+1}-a_{1},~a_{k+2}-a_{2},~\dots,~a_{n}-a_{n-k}),<br>$$<br>我们可以先计算后面一长串式子，取 $m$​ 为这个数即可，注意题目要求，$m\ge2$​，因此若结果等于 $1$​，表明 $m$​​ 不存在。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxN = <span class="number">2e5</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, ans, a[maxN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b &gt; <span class="number">0</span> ? <span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">sol</span><span class="params">(<span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - k; i++) &#123;</span><br><span class="line">        m = <span class="built_in">gcd</span>(m, <span class="built_in">abs</span>(a[i + k] - a[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> m != <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i * i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i * i == n) &#123;</span><br><span class="line">                    ans += <span class="built_in">sol</span>(i);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    ans += <span class="built_in">sol</span>(i);</span><br><span class="line">                    ans += <span class="built_in">sol</span>(n / i);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CF921B-A-Balanced-Problemset"><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1925/problem/B">CF921B. A Balanced Problemset</a></h2><p><strong>题意</strong> 给定 $x,k$，令 $x=a_1+a_2+\dots+a_k$，给出一种拆分方法，使 $m=\gcd a$ 最大。</p><p><strong>思路</strong> 注意到，$m\leqslant\min a\leqslant\frac{x}{k}$，且 $m~|~a_i\Rightarrow m~|~x$，故 $m$ 是 $x$ 的不大于 $\frac{x}{k}$ 的最大约数。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n = <span class="built_in">read</span>(), k = <span class="built_in">read</span>(), ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n / i; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= k) ans = <span class="built_in">max</span>(ans, n / i);</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= n / k) ans = <span class="built_in">max</span>(ans, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(ans);</span><br></pre></td></tr></table></figure><h1>枚举 1 ~ N 每个数的约数</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; fac[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; i * j &lt; N; j++) &#123;</span><br><span class="line">            fac[i * j].<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度：$O(N+\cfrac{N}{2}+\cfrac{N}{3}+\dots+\cfrac{N}{N})=O(N\log N)$</p><p>两个推论：</p><ol><li>一个整数 $N$ 的约数个数上界为 $2\sqrt{N}$</li><li>$1\sim N$ 每个数的约数个数的总和大约为 $N\log N$</li></ol><p>例：[[…/ 图论 - 树 / 树习题集 #2024 杭电多校 3001 - 深度自同构 |2024 杭电多校 3001 - 深度自同构]]</p><h1>枚举 L ~ R 每个数的约数</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Sieve</span> &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; prime;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; isntPrime;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">        isntPrime.<span class="built_in">resize</span>(N + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isntPrime[i]) prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; p : prime) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1ll</span> * i * p &gt; N) <span class="keyword">break</span>;</span><br><span class="line">                isntPrime[i * p] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (i % p == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        isntPrime[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sieve;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Divisor</span> &#123;</span><br><span class="line">    ll L, R, len;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;&amp; prime = sieve.prime;</span><br><span class="line">    vector&lt;vector&lt;pll&gt; &gt; primeFactor;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">cal</span><span class="params">(ll num, ll d)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;ll&gt; <span class="title">a</span><span class="params">(len)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; len; i++) a[i] = L + i;</span><br><span class="line"></span><br><span class="line">        primeFactor.<span class="built_in">resize</span>(len);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; p : prime) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1ll</span> * p * p &gt; R) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">for</span> (ll i = (-L % p + p) % p; i &lt; len; i += p) &#123;</span><br><span class="line">                <span class="keyword">if</span> (a[i] % p) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> (a[i] % p == <span class="number">0</span>) a[i] /= p, ++c;</span><br><span class="line">                primeFactor[i].<span class="built_in">emplace_back</span>(p, c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] &gt; <span class="number">1</span>) primeFactor[i].<span class="built_in">emplace_back</span>(a[i], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">factor</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        vector&lt;ll&gt; d;</span><br><span class="line"></span><br><span class="line">        d.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [p, c] : primeFactor[x]) &#123;</span><br><span class="line">            ll siz = d.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span> (ll i = <span class="number">0</span>, pow = p; i &lt; c; i++, pow *= p) &#123;</span><br><span class="line">                <span class="keyword">for</span> (ll k = <span class="number">0</span>; k &lt; siz; ++k)</span><br><span class="line">                    d.<span class="built_in">push_back</span>(d[k] * pow);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(ll l, ll r)</span> </span>&#123;</span><br><span class="line">        L = l, R = r, len = R - L + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; d : <span class="built_in">factor</span>(i)) <span class="built_in">cal</span>(i, d);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Divisor::cal</span><span class="params">(ll num, ll d)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sieve.<span class="built_in">init</span>(<span class="number">1000000</span>);</span><br><span class="line"></span><br><span class="line">    Divisor div;</span><br><span class="line">    div.<span class="built_in">solve</span>(L, R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度 $\Theta\left(\sqrt{ R} + \sum d(i) \right)$，其中 $d(i)$ 表示 $i$ 的约数个数。</p><h2 id="2024- 牛客多校 -8E-Haitang-and-Math">2024 牛客多校 8E - Haitang and Math</h2><p>[[…/contests/2024 牛客多校 /2024-08-08：2024 牛客暑期多校训练营 8|2024-08-08：2024 牛客暑期多校训练营 8]]</p><p><strong>题意</strong> 给定 $n$，满足如下条件的 $m$ 的数量：</p><ul><li>$1 \leqslant m \leqslant n$；</li><li>$n\bmod m$ 等于 $m$ 的数码和 $S(m)$。</li></ul><p><strong>思路</strong> 枚举 $S(m)$，再枚举 $m$，逐个检验。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = pair&lt;ll, ll&gt;;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">8</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll S = <span class="number">0</span>, C = <span class="number">0</span>; <span class="type">char</span> Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &gt; <span class="number">57</span> || Y &lt; <span class="number">48</span>) C |= Y == <span class="number">45</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &lt;= <span class="number">57</span> &amp;&amp; Y &gt;= <span class="number">48</span>) S = (S &lt;&lt; <span class="number">3</span>) + (S &lt;&lt; <span class="number">1</span>) + Y - <span class="number">48</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> C ? -S : S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Sieve</span> &#123; ... &#125; sieve;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Divisor</span> &#123; ... &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">beforeT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sieve.<span class="built_in">init</span>(<span class="number">1000000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数码和 </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getDigitSum</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x) sum += x % <span class="number">10</span>, x /= <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll n;</span><br><span class="line">vector&lt;ll&gt; res;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Divisor::cal</span><span class="params">(ll num, ll d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n % d == <span class="built_in">getDigitSum</span>(d)) &#123;</span><br><span class="line">        res.<span class="built_in">push_back</span>(d);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">vector</span>&lt;ll&gt;().<span class="built_in">swap</span>(res);</span><br><span class="line"></span><br><span class="line">    Divisor div;</span><br><span class="line">    div.<span class="built_in">solve</span>(<span class="built_in">max</span>(<span class="number">1ll</span>, n - <span class="number">108</span>), n);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sort</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> siz = <span class="built_in">unique</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>()) - res.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, siz);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">beforeT</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> T = <span class="built_in">read</span>(); T--; <span class="built_in">eachT</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>赛时写法如下，保证计数不重，但暂不知原理：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Divisor::cal</span><span class="params">(ll num, ll d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d &gt;= <span class="number">10</span> &amp;&amp; <span class="built_in">getDigitSum</span>(d) == R - L - num) &#123;</span><br><span class="line">        sum += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll n = <span class="built_in">read</span>();</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    div.<span class="built_in">solve</span>(<span class="built_in">max</span>(<span class="number">1ll</span>, n - <span class="number">108</span>), n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="反素数">反素数</h2><h3 id="Description-2">Description</h3><p>对于任何正整数 $x$，其约数的个数记作 $g(x)$，例如 $g(1)=1、g(6)=4$。</p><p>如果某个正整数 $x$ 满足：对于任意的小于 $x$ 的正整数 $i$，都有 $g(x)&gt;g(i)$，则称 $x$ 为反素数。</p><p>例如，整数 $1，2，4，6$ 等都是反素数。</p><p>现在给定一个数 $N$，请求出不超过 $N$ 的最大的反素数。</p><h4 id="输入格式 -2">输入格式</h4><p>一个正整数 $N$。</p><h4 id="输出格式 -2">输出格式</h4><p>一个整数，表示不超过 $N$ 的最大反素数。</p><h4 id="数据范围 -2">数据范围</h4><p>$1 \le N \le 2*10^9$</p><h4 id="输入样例：">输入样例：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1000</span><br></pre></td></tr></table></figure><h4 id="输出样例：">输出样例：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">840</span><br></pre></td></tr></table></figure><h3 id="Notes-2">Notes</h3><p>注意到：</p><ol><li>对于一个 $N$ , 设答案为 $x$ , 那么 $x$ 的约数一定是 $1\sim N$ 中最多的</li><li>若有 $y$ 的约数与 $x$ 的约数一样多，那么一定有 $x&lt;y$</li><li>设 $x=p_{1}^{c_{1}}p_{2}^{c_{2}}\dots p_{m}^{c_{m}}$ ，一定有 $c_{1} \geqslant c_{2} \geqslant \dots \geqslant c_{m}$</li><li>$x$ 的质因子 $p$ 只会在 $2,3,5,7,11,13,17,19,23$ 中取，<br>因为 $2<em>3</em>5<em>7</em>11<em>13</em>17<em>19</em>23*29$ 已经大于 $2e^{9}$</li></ol><p>那么，我们就可以用 dfs 枚举<br>经过测试，哪怕 $n=2e^{9}$ , 枚举次数也仅为 $1451$ 次</p><h3 id="Code-2">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll ps[] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> x;</span><br><span class="line"><span class="type">int</span> num = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> pre, <span class="type">int</span> p, <span class="type">int</span> s)</span> <span class="comment">// u: 枚举的位置 pre: 上个的指数 p: 数的大小 s: 约数个数 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == <span class="number">9</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (s &gt; num || (s == num &amp;&amp; p &lt; x))</span><br><span class="line">    &#123;</span><br><span class="line">        num = s;</span><br><span class="line">        x = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= pre; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p * ps[u] &gt; n)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        p *= ps[u];</span><br><span class="line">        <span class="built_in">dfs</span>(u + <span class="number">1</span>, i, p, s * (i + <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">30</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="余数之和">余数之和</h2><h3 id="Description-3">Description</h3><p>给出正整数 $n$ 和 $k$，计算 $j(n, k)=k \bmod 1 + k \bmod 2 + k \bmod 3 + … + k \bmod n$ 的值。</p><p>例如 $j(5, 3)=3 \bmod 1 + 3 \bmod 2 + 3 \bmod 3 + 3 \bmod 4 + 3 \bmod 5=0+1+0+3+3=7$。</p><h4 id="输入格式 -3">输入格式</h4><p>输入仅一行，包含两个整数 $n, k$。</p><h4 id="输出格式 -3">输出格式</h4><p>输出仅一行，即 $j(n, k)$。</p><h4 id="数据范围 -3">数据范围</h4><p>$1 \le n,k \le 10^9$</p><h3 id="Notes-3">Notes</h3><p>$\sum_{i = 1}^{n} k \bmod i = n * k - \sum_{i = 1}^{n} \lfloor k / i \rfloor * i$</p><p>显然，$\lfloor k / i \rfloor$ 是最棘手的，我们要想办法简化计算。</p><h4 id="证明单调性">证明单调性</h4><ul><li><p>观察 $\lfloor k / i \rfloor$，显然随着 $i$ 的增大，这个式子是越来越小的。</p></li><li><p>又因为有向下取整符号，所以该式子取值只能是整数。</p></li></ul><p>若我们设函数 $f(x) = \lfloor k / x \rfloor$。则画在坐标轴中应该是从高到低一条条横线。</p><p><img src="https://i.loli.net/2019/12/01/4ocKnIkdlrW9JMs.png" alt=""></p><p>上图是一条 $f(x) = \lfloor 10 / x \rfloor$ 的图像。</p><h4 id="证明该式子最多只有 -2-sqrt-k- 个取值">证明该式子最多只有 $2\sqrt{k}$ 个取值</h4><p>分段讨论：</p><ul><li>当 $i &lt;= \sqrt{k}$ 时，因为 $i$ 是 $1$ 到 $\sqrt{k}$ 的整数，所以最多只有 $\sqrt{k}$ 个不同的 $\lfloor k / i \rfloor$ 值。</li><li>当 $i &gt; \sqrt{k}$ 时，$\lfloor k / i \rfloor &lt;= \sqrt{k}$，又因为式子取整了，所以式子只能取 $1$ 到 $\sqrt{k}$ 的整数，故最多也只有 $\sqrt{k}$ 个不同的 $\lfloor k / i \rfloor$ 值。</li></ul><p>综上所述，$\lfloor k / i \rfloor$ 最多只有 $2\sqrt{k}$ 个取值</p><hr><p>有关 当 $i &gt; \sqrt{k}$ 时，$\lfloor k / i \rfloor &lt;= \sqrt{k}$ 的证明：</p><p>由于下取整，所以 $\lfloor k / i \rfloor * i &lt;= k$ ①</p><p>假设 $\lfloor k / i \rfloor &gt; \sqrt{k} $，有 $\lfloor k / i \rfloor * i &gt; \lfloor k / i \rfloor * \sqrt{k} &gt; \sqrt{k} ^ 2 = k$。②</p><p>① 与 ② 矛盾</p><hr><p>通过以上步骤，我们可以知道这个答案由连续 $2\sqrt{k}$ 段不同的取值组成，那么我们只需要确定每种取值是下界 $l$ 和 上界 $r$。通过 $\sum_{i = l}^{r} \lfloor k / i \rfloor * i = \sum_{i = l}^{r} \lfloor k / l \rfloor * i = \lfloor k / l \rfloor * (\sum_{i = l}^{r}i)$ 即可求得每一段对答案的贡献。$(\sum_{i = l}^{r}i)$ 可以用等差数列求和公式计算。</p><h4 id="已知下界求上界">已知下界求上界</h4><p>假设我们知道一段相同取值的下界是 $x$，若能求出上界，我们问题便解决了。</p><p>猜想若下界是 $x$，上界是 $r = \lfloor k / \lfloor k / x \rfloor \rfloor$</p><p>第一步、求证 $\lfloor k / x \rfloor = \lfloor k / r \rfloor$</p><ul><li><p>由定义式可知 $r * \lfloor k / x \rfloor + q = k$ ③，其中 $0 &lt;= q &lt; \lfloor k / x \rfloor$，所以 $\lfloor k / r \rfloor = \lfloor\frac{r * \lfloor k / x \rfloor + q}{r}\rfloor = \lfloor k / x \rfloor + \lfloor \frac{q}{r} \rfloor &gt;= \lfloor k / x \rfloor$</p></li><li><p>$r &gt;= \lfloor k / (k / x) \rfloor = x$，所以 $\lfloor k / x \rfloor &gt;= \lfloor k / r \rfloor$</p></li></ul><p>综上 $\lfloor k / x \rfloor = \lfloor k / r \rfloor$。</p><hr><p>第二步、求证 $\lfloor k / (r + 1) \rfloor \not = \lfloor k / x \rfloor$</p><p>假设 $\lfloor k / (r + 1) \rfloor = \lfloor k / x \rfloor$</p><p>那么有 $(r + 1) * \lfloor k / x \rfloor + q’ = k$，其中 $0 &lt;= q &lt; r + 1$</p><p>把式子变化一下：</p><p>$r * \lfloor k / x \rfloor + \lfloor k / x \rfloor + q’ = k $ ④</p><p>③④ 联立，有：</p><p>$\lfloor k / x \rfloor + q’ &lt; \lfloor k / x \rfloor$</p><p>因为 $q’ &gt;= 0$，所以该式子矛盾，故假设不成立。</p><hr><p>通过这两步及之前的单调性，我们知道 $\lfloor k / \lfloor k / x \rfloor \rfloor$ 一定是上界</p><h4 id="算法">算法</h4><p>所以算法就很好设计了：</p><ul><li>设 $l = 1$，算出上界 $r$。计算这段的贡献</li><li>使 $l = r + 1$，即跳到下一段计算贡献。</li><li>重复知道算完 $[1, n]$ 里所有段。</li></ul><p>$Tips:$</p><ol><li>当 $\lfloor k / l \rfloor = 0$ 的时候，显然这段以及后面（有单调性）已经没有贡献了，可以 $break$。（或者直接设右端点为 $n$）</li><li>注意右端点和 $n$ 取个 $min$，因为 &gt; n 没有贡献了。</li></ol><h3 id="Codes">Codes</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">int</span> n, k, l, r;</span><br><span class="line">LL ans;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    ans = (LL)n * k;</span><br><span class="line">    <span class="keyword">for</span> (l = <span class="number">1</span>; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(k / l == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        r = <span class="built_in">min</span>(k / (k / l), n);</span><br><span class="line">        ans -= (LL)(k / l) * (l + r) * (r - l + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>最大公约数（gcd）</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度 $\Theta(\log (a+b))$。</p><h2 id="VJwin6G-GCD-Table"><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/582/A">VJwin6G - GCD Table</a></h2><p><strong>题意</strong> 给出抹去表头、内容乱顺序排列的最大公约数表，还原表头。</p><p><strong>思路</strong> 举个栗子，</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\ <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">6</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">6</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><p>输入的可能是这么一串数（当然它是随机排列的）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><p>先用两个数组把它存起来，即</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>&#125;;                         <span class="comment">// 存数（排序后）</span></span><br><span class="line">mp[<span class="number">1</span>]=<span class="number">4</span>, mp[<span class="number">2</span>]=<span class="number">3</span>, mp[<span class="number">3</span>]=<span class="number">8</span>, mp[<span class="number">6</span>]=<span class="number">1</span>;     <span class="comment">// 记次数 </span></span><br></pre></td></tr></table></figure><p>由于给的这一串数一定包含表头本身，所以最大数和第二大的数都包含在其中（用反证法不难证明），本例中，<code>6</code> 和 <code>3</code> 一定是所求，记录答案，而且这两个数已经用过一次了，从 <code>mp[]</code> 数组中删去，现在是</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>&#125;;</span><br><span class="line">mp[<span class="number">1</span>]=<span class="number">4</span>, mp[<span class="number">2</span>]=<span class="number">3</span>, mp[<span class="number">3</span>]=<span class="number">7</span>, mp[<span class="number">6</span>]=<span class="number">0</span>;        <span class="comment">// 删去了一个 3 和一个 6</span></span><br><span class="line">ans[]=&#123;<span class="number">6</span>,<span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure><p>既然找到了 <code>6</code> 和 <code>3</code>，那它们的最大公约数也可以从表中删去，而且根据对称性，删两个，现在是</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">mp[<span class="number">1</span>]=<span class="number">4</span>, mp[<span class="number">2</span>]=<span class="number">3</span>, mp[<span class="number">3</span>]=<span class="number">5</span>, mp[<span class="number">6</span>]=<span class="number">0</span>;        <span class="comment">// 删去了两个 gcd(3,6)=3</span></span><br><span class="line">ans[]=&#123;<span class="number">6</span>,<span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure><p>现在数组中的最大数是 <code>3</code> 了（<code>6</code> 的次数为 <code>0</code>，就当它不存在了），所以这个 <code>3</code> 也是结果之一，再删除它和已知两个数的最大公约数，现在是</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num[]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">mp[<span class="number">1</span>]=<span class="number">4</span>, mp[<span class="number">2</span>]=<span class="number">3</span>, mp[<span class="number">3</span>]=<span class="number">0</span>, mp[<span class="number">6</span>]=<span class="number">0</span>;        <span class="comment">// 删去了 3, 两个 gcd(3,3)=3, 两个 gcd(3,6)=3</span></span><br><span class="line">ans[]=&#123;<span class="number">6</span>,<span class="number">3</span>,<span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure><p>进而，</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num[]=&#123;&#125;;</span><br><span class="line">mp[<span class="number">1</span>]=<span class="number">0</span>, mp[<span class="number">2</span>]=<span class="number">0</span>, mp[<span class="number">3</span>]=<span class="number">0</span>, mp[<span class="number">6</span>]=<span class="number">0</span>;        <span class="comment">// 删去了 2, 两个 gcd(2,3)=1, 两个 gcd(2,3)=1, 两个 gcd(2,6)=2</span></span><br><span class="line">ans[]=&#123;<span class="number">6</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>&#125;;</span><br></pre></td></tr></table></figure><p>至此，<code>num[]</code> 数组为空，删数完毕，结果便已经得到。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    map&lt;<span class="type">int</span>, ll&gt; cnt;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; num, ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n * n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="keyword">if</span> (!cnt.<span class="built_in">count</span>(x)) num.<span class="built_in">push_back</span>(x);       <span class="comment">// 存数 num[]=&#123;2,1,3,6&#125;</span></span><br><span class="line">        cnt[x]++;                                  <span class="comment">// 记次数 cnt[1]=4, cnt[2]=3, cnt[3]=8, cnt[6]=1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(num.<span class="built_in">begin</span>(), num.<span class="built_in">end</span>());                  <span class="comment">// num[]=&#123;1,2,3,6&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (num.<span class="built_in">size</span>() &gt; <span class="number">0</span> &amp;&amp; ans.<span class="built_in">size</span>() &lt; n) &#123;</span><br><span class="line">        <span class="keyword">while</span> (!cnt[num.<span class="built_in">back</span>()]) num.<span class="built_in">pop_back</span>();   <span class="comment">// 防止空数据，如 cnt[4],cnt[5] 一槪跳过 </span></span><br><span class="line">        ans.<span class="built_in">push_back</span>(num.<span class="built_in">back</span>());                 <span class="comment">// 从最大开始记录 ans[1]=num[6]</span></span><br><span class="line">        --cnt[num.<span class="built_in">back</span>()];                         <span class="comment">// 删掉这个最大值 ans[1]</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; ans.<span class="built_in">size</span>() - <span class="number">1</span>; ++j) &#123;    <span class="comment">// 现在有 outcnt=1 个已知的数 </span></span><br><span class="line">            cnt[<span class="built_in">gcd</span>(num.<span class="built_in">back</span>(), ans[j])] -= <span class="number">2</span>;     <span class="comment">// 删掉与其它已知数的 gcd，对称性删两个 </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>评注</strong> 核心在于删数的方法：最大的两个数一定是所求，删第一个数不用考虑附属的删谁，因为这时可以确定第二个数，之后每次删数时直接删与其它已知数的 $\gcd$ 就行。</p><h2 id="VJwin6B-gcd"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P8443">VJwin6B - gcd.</a></h2><p><strong>题意</strong> 求 $\displaystyle\gcd(\lfloor \frac{l}{x}\rfloor,\lfloor \frac{l+1}{x}\rfloor,\cdots,\lfloor \frac{r}{x}\rfloor)$。</p><p><strong>思路</strong> 逐项算…… 然后 $\mathbf{TLE}$……</p><p>优化，只需算 $\displaystyle\gcd(\lfloor \frac{l}{x}\rfloor,\lfloor \frac{l}{x}\rfloor+1,\cdots,\lfloor \frac{r}{x}\rfloor)$，项数减少了很多，但依然 $\mathbf{TLE}$……</p><p>继续优化，如果算到某个 $\gcd=1$，就跳出，这样 $\rm AC$ 了。</p><p><strong>评注</strong> 事实上除非 $\displaystyle\lfloor \frac{l}{x}\rfloor=\lfloor \frac{r}{x}\rfloor$，结果都是 $1$，因为相邻两个自然数的 $\gcd=1$，这也是没有 $\rm TLE$ 的原因。</p><h2 id="VJwin6C-GCD-LCM"><a target="_blank" rel="noopener" href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2383">VJwin6C - GCD LCM</a></h2><p><strong>题意</strong> 给出 $\gcd(a,b)$ 和 $\rm lcm(a,b)$，找出一组 $(a,b)$。</p><p><strong>思路</strong> 如果 $\gcd(a,b)\nmid\rm lcm(a,b)$，那么 $(a,b)$ 不存在，如果存在，取这两个数本身，即 $a=\gcd(a,b),~b={\rm lcm}(a,b)$ 即可。</p><h2 id="VJwin13D- 小道消息"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5535">VJwin13D - 小道消息</a></h2><p><strong>题意</strong> 有 $n$ 个数 $2,3,\dots,n+1$，零时刻将 $k$ 涂色，每时刻对于每个有颜色的数 $i$，若 $(i,j)=1$，则将 $j$ 涂色，在 $t$ 时刻所有数都有颜色，求 $t$。</p><p><strong>思路</strong> 注意到，每一时刻，奇数能传染所有偶数，偶数能传染所有奇数，因此 $t\leqslant2$。能否 $k=1$ 呢？只要 $k$ 与其它所有数互素即可。我们考虑 $t=2$ 的情形，即 $\exists j,~\text{s.t.}(k,j)\ne1$：</p><ul><li>$k$ 为合数：设 $k=pk_0$，取 $j=p$，则 $(k,j)=p&gt;1$；</li><li>数列中存在 $2k$，这等价于 $n\geqslant 2k$。</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans = (!<span class="built_in">isPrime</span>(k + <span class="number">1</span>)) || n &gt;= <span class="number">2</span> * k + <span class="number">1</span>) ? <span class="number">2</span> : <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><strong>评注</strong> 给出暴力代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">a[k] = aa[k] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (!<span class="built_in">check</span>()) &#123;</span><br><span class="line">    ans++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">gcd</span>(i + <span class="number">1</span>, j + <span class="number">1</span>) == <span class="number">1</span>) aa[j] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        a[i] = aa[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure><p><strong>评注二</strong><br>$$<br>\begin{array}{rl}</p><p>\text{Bertrand-Chebyshev}\quad</p><p>&amp;\forall n&gt;3,~\exists~ p,\text{s.t.}n&lt;p&lt;2n-2, \</p><p>&amp;\forall n&gt;1,~\exists~ p,\text{s.t.}n&lt;p&lt;2n. \</p><p>\text{Generation1}\quad<br>&amp;\forall n&gt;1,~\nexists~ m,r&gt;1,\text{s.t.}A_n^n=m^r. \</p><p>\text{Generation2}\quad<br>&amp;\forall n&gt;0,~\nexists~ m,r&gt;1,\text{s.t.}C_{2n}^n=m^r.</p><p>\end{array}<br>$$</p><h2 id="VJwin15B- 添加括号 III（贪心）"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2651">VJwin15B - 添加括号 III</a>（贪心）</h2><p><strong>题意</strong> 给出一个表达式，形如 $a_{0}/a_{1}/a_{2}/a_{3}/…/a_{n}$，问是否可以通过添加一些括号改变运算顺序使其成为一个整数。</p><p><strong>思路</strong> 添加括号为 $a_{0}/\big(a_{1}/a_{2}/a_{3}/…/a_{n}\big)$，如果此时不能为整数，那么其它情形也不可能。</p><p>问题转化为判断 $a_0a_2a_3\dots a_n\bmod a_1=0$。</p><p>实际判断 $[a_0, a_2, a_3, …, a_n]\bmod a_1=0$ 即可。前面那一大坨没有 $a_1$ 的约数就寄了，可以边算边除，只保留和 $a_1$ 有公共约数的那一部分，也即最大公约数。</p><p>具体地说，对 $a_1$ 和 $a_i$，保留最大公约数，先变为 $a_1$ 和 $(a_1,a_i)$。然后来了 $a_j$，变为 $a_1$ 和 $(a_1,a_i)\times(a_1,a_j)$，最终要判断 $(a_1,a_i)\times(a_1,a_j)\times\dots\bmod a_1$<br>等价于 $\gcd(a_1,a_j)\times\dots \bmod a_1/\gcd(a_1,a_i)$。这时我们发现每次将 $a_1$ 变为 $(a_1,a_i)$ 就足够了，最终是 $1\bmod a_1’$，只需判断 $a_1’=1$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;x, &amp;a);</span><br><span class="line">a /= <span class="built_in">gcd</span>(a, x);</span><br><span class="line"><span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x);</span><br><span class="line">    a /= <span class="built_in">gcd</span>(a, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, a == <span class="number">1</span> ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="2024- 牛客多校 -4H-Yet-Another-Origami-Problem（思维）">2024 牛客多校 4H - Yet Another Origami Problem（思维）</h2><p><strong>题意</strong> 给两种操作：排序数组后在值域上翻折一个前缀或翻折一个后缀，问任意次操作能做到的最小极差。</p><p><strong>思路</strong> 排序去重后，答案为 $\gcd(a_{i+1}-a_{i})$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; i : a) i = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    ll d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        d = <span class="built_in">gcd</span>(d, a[i] - a[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2024- 牛客多校 -8A-Haitang-and-Game（思维）">2024 牛客多校 8A - Haitang and Game（思维）</h2><p>[[…/contests/2024 牛客多校 /2024-08-08：2024 牛客暑期多校训练营 8|2024-08-08：2024 牛客暑期多校训练营 8]]</p><p><strong>题意</strong> 给定一个集合 $S$。dXqwq 和 Haitang 轮流在集合中选择两个数，并将它们的最大公约数插入集合中，集合中元素不可相同。不可操作者败，求胜者。数据范围：$1 \leqslant n \leqslant 10^{5},\ 1 \leqslant a_{i} \leqslant 10^{5}$，保证 $a_{i}$ 严格单调递增。</p><p><strong>思路</strong> 如果新插入的数的个数为奇数，dXqwq 胜，否则 Haitang 胜。我们推算最终集合。要判断最终集合中是否有 $d$，只需判断所有 $d$ 的倍数的最大公约数是否是 $d$。枚举 $d$。时间复杂度为调和级数 $\Theta(n\log n)$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mp</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="built_in">read</span>();</span><br><span class="line">        mp[x] += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = -n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt; N; j += i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp[j]) &#123;</span><br><span class="line">                d = <span class="built_in">gcd</span>(d, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res += d == i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, res &amp; <span class="number">1</span> ? <span class="string">&quot;dXqwq&quot;</span> : <span class="string">&quot;Haitang&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2024- 牛客多校 -10F-Collinear-Exception">2024 牛客多校 10F. Collinear Exception</h2><p>[[…/contests/2024 牛客多校 /2024-08-15：2024 牛客暑期多校训练营 10|2024-08-15：2024 牛客暑期多校训练营 10]]</p><p>给定一个二维平面点的排列，从前到后依次插入一个初始为空集合。如果插入后会导致三点共线，那么会跳过这次插入。输出每次插入是否成功。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> vis[N][N];</span><br><span class="line"><span class="type">int</span> res[N * N];</span><br><span class="line">pii S[N * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n * n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (vis[x][y]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[x][y] += <span class="number">1</span>;</span><br><span class="line">        res[i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; cnt; ++j) &#123;</span><br><span class="line">            <span class="keyword">auto</span>&amp; [x0, y0] = S[j];</span><br><span class="line">            <span class="type">int</span> dx = x - x0, dy = y - y0, x1, y1;</span><br><span class="line">            <span class="type">int</span> d = <span class="built_in">gcd</span>(dx, dy);</span><br><span class="line">            dx /= d, dy /= d;</span><br><span class="line"></span><br><span class="line">            x1 = x0 + dx, y1 = y0 + dy;</span><br><span class="line">            <span class="keyword">while</span> (x1 &lt;= n &amp;&amp; y1 &lt;= n &amp;&amp; x1 &gt;= <span class="number">1</span> &amp;&amp; y1 &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">                vis[x1][y1] += <span class="number">1</span>;</span><br><span class="line">                x1 += dx, y1 += dy;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            x1 = x0 - dx, y1 = y0 - dy;</span><br><span class="line">            <span class="keyword">while</span> (x1 &lt;= n &amp;&amp; y1 &lt;= n &amp;&amp; x1 &gt;= <span class="number">1</span> &amp;&amp; y1 &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">                vis[x1][y1] += <span class="number">1</span>;</span><br><span class="line">                x1 -= dx, y1 -= dy;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        S[cnt++] = &#123; x, y &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n * n; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, res[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>互质与欧拉函数</h1><p>$1\sim N$ 中与 $N$ 互质的个数被称为欧拉函数，记为 $\varphi(N)$<br>若在算术基本定理中，$N = p_{1}^{c_{1}}p_{2}^{c_{2}}\dots p_{m}^{c_{m}}$ ，则 :<br>$$<br>\varphi(N) = N*\cfrac{(p_{1}-1)}{p_{1}}<em>\cfrac{(p_{2}-1)}{p_{2}}</em>\dots*\cfrac{(p_{m}-1)}{p_{m}}<br>$$ 性质：</p><ol><li>$\forall n&gt;1,1\sim n$ 中与 $n$ 互质的数的和为 $\cfrac{n*\varphi(n)}{2}$</li><li>若 $a,b$ 互质，则 $\varphi(ab)=\varphi(a)\varphi(b)$</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> m;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            p[++m] = i;</span><br><span class="line">            c[m] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>)</span><br><span class="line">                c[m]++, n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) <span class="comment">// n 是质数 </span></span><br><span class="line">    &#123;</span><br><span class="line">        p[++m] = n, c[m] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">divide</span>(n);</span><br><span class="line">    ll ans = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = ans * (p[i] - <span class="number">1</span>) / p[i];  <span class="comment">// 注意这里不能缩写 </span></span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>时间复杂度：$O(\sqrt{ N})$<br>若加上素数筛，时间复杂度的常数会更小</p><h1>暴力枚举 lcm</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span> * a * b / <span class="built_in">gcd</span>(a, b); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">8</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; divisor[N];</span><br><span class="line">vector&lt;pii&gt; pairs[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initlcm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> L = i; L &lt; N; L += i)</span><br><span class="line">            divisor[L].<span class="built_in">emplace_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> L = i; L &lt; N; L += i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span>&amp; j : divisor[L]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= j <span class="keyword">and</span> <span class="built_in">lcm</span>(i, j) == L)</span><br><span class="line">                    pairs[L].<span class="built_in">emplace_back</span>(i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>同余</h1><h2 id="2024- 牛客多校 -3B-Crash-Test">2024 牛客多校 3B - Crash Test</h2><p>[[…/contests/2024-07-23：2024 牛客暑期多校训练营 3|2024-07-23：2024 牛客暑期多校训练营 3]]</p><p><strong>题意</strong> 给定 $n$ 类操作，每次可将 $x$ 更新为 $\left|x-a_i\right|$，求从 $D$ 开始可得到的最小值。<br>数据范围：$n \leqslant 100,\ 1 \leqslant a_i, D \leqslant 10^{18}$。</p><p><strong>思路</strong> 直观感受为裴蜀定理，设 $d=\gcd a,\ r=D \bmod d$，答案为 $\min\lbrace r,d-r \rbrace$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll S = <span class="number">0</span>, C = <span class="number">0</span>; <span class="type">char</span> Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &gt; <span class="number">57</span> || Y &lt; <span class="number">48</span>) C |= Y == <span class="number">45</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &lt;= <span class="number">57</span> &amp;&amp; Y &gt;= <span class="number">48</span>) S = (S &lt;&lt; <span class="number">3</span>) + (S &lt;&lt; <span class="number">1</span>) + Y - <span class="number">48</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> C ? -S : S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    ll D = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    ll d = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ll x = <span class="built_in">read</span>();</span><br><span class="line">        d = <span class="built_in">gcd</span>(d, <span class="built_in">read</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll left = D % d;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">min</span>(left, d - left));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CF1994D-Funny-Game">CF1994D. Funny Game</h2><p><strong>题意</strong> 给定一个只有点没有边的图，点权为 $a_{i}$，进行 $n - 1$ 次操作，第 $i~(1 \leqslant i \leqslant n-1)$ 次操作定义为：</p><ul><li>任意选择 $2$ 个点 $u,v$，满足 $|a_u - a_v|$ 被 $i$ 整除，在 $u$ 和 $v$ 间连一条边．</li></ul><p>判断能否将图连为一棵树，如果能，给出操作方案．</p><p><strong>思路</strong> 为什么选择倒着连？第 $x$ 次操作的时候有 $x+1$ 个连通块，每个连通块即使选一个数出来也一定存在两个数同余 $x$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll S = <span class="number">0</span>, C = <span class="number">0</span>; <span class="type">char</span> Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &gt; <span class="number">57</span> || Y &lt; <span class="number">48</span>) C |= Y == <span class="number">45</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (Y &lt;= <span class="number">57</span> &amp;&amp; Y &gt;= <span class="number">48</span>) S = (S &lt;&lt; <span class="number">3</span>) + (S &lt;&lt; <span class="number">1</span>) + Y - <span class="number">48</span>, Y = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> C ? -S : S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 并查集 </span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e3</span> + <span class="number">8</span>;</span><br><span class="line"><span class="type">int</span> fa[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123; <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++) fa[i] = i; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = <span class="built_in">find</span>(fa[x]); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">uno</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; fa[<span class="built_in">find</span>(x)] = <span class="built_in">find</span>(y); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">same</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eachT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; x : a) x = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = n - <span class="number">1</span>; k &gt;= <span class="number">1</span>; k--) &#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mp</span><span class="params">(k, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">auto</span>&amp; j = mp[a[i] % k];</span><br><span class="line">            <span class="keyword">if</span> (j != <span class="number">-1</span> &amp;&amp; !<span class="built_in">same</span>(i, j)) &#123;</span><br><span class="line">                <span class="built_in">uno</span>(i, j);</span><br><span class="line">                ans.<span class="built_in">push_back</span>(&#123; i, j &#125;);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                j = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;YES\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = ans.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">auto</span>&amp; [u, v] = ans[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, u + <span class="number">1</span>, v + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> T = <span class="built_in">read</span>(); T--; <span class="built_in">eachT</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>数论倒数</h1><h2 id="VJwin13I- 模意义下的乘法逆元 -2"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5431">VJwin13I - 模意义下的乘法逆元 2</a></h2><p><strong>题意</strong> 求 $\displaystyle\sum_{i=1}^{n}\frac{k^i}{a_i}\bmod p$。</p><p><strong>思路</strong> 为减小时间复杂度，我们只能计算一次数论倒数。</p><p><strong>方法一</strong> 边计算边通分。设前 $i-1$ 项的和为 $\displaystyle\frac{f_1}{f_2}$，则前 $i$ 项的和为 $\displaystyle\frac{f_1}{f_2}+\frac{k^i}{a_i}=\frac{a_if_1+k^if_2}{a_if_2}$，故令 $f_1:=a_if_1+k^if_2,~f_2:=a_if_2$，最终的结果是 $f_1\cdot f_2^{-1}\bmod p$，只需计算一次数论倒数，时间复杂度 $\Theta(n+\log p)$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span>(n), <span class="built_in">read</span>(p), <span class="built_in">read</span>(k);</span><br><span class="line">ll pow = <span class="number">1</span>, frac1 = <span class="number">0</span>, frac2 = <span class="number">1</span>; <span class="comment">// k 的幂 分子 分母 </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">read</span>(x);</span><br><span class="line">    pow = (pow * k) % p;</span><br><span class="line">    frac1 = (frac1 * x + frac2 * pow) % p;</span><br><span class="line">    frac2 = (frac2 * x % p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(frac1 * <span class="built_in">Inv</span>(frac2, p) % p);</span><br></pre></td></tr></table></figure><p><strong>方法二</strong> 直接通分，结果为 $\displaystyle\frac{\sum_{i=1}^{n}k^ia_1\dots a_{i-1}a_{i+1}\dots a_n}{a_1a_2\dots a_n}$，对于分母，可以预处理 ${a_i}$ 的前缀积和后缀积，时间复杂度 $\Theta(3n+\log p)$。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span>(n), <span class="built_in">read</span>(p), <span class="built_in">read</span>(k);</span><br><span class="line">ll ans = <span class="number">0</span>, pow = <span class="number">1</span>;</span><br><span class="line">fst[<span class="number">0</span>] = lst[n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">read</span>(a[i]);</span><br><span class="line">    fst[i] = fst[i - <span class="number">1</span>] * a[i] % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = n; i; --i)</span><br><span class="line">    lst[i] = lst[i + <span class="number">1</span>] * a[i] % p;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    pow = (pow * k) % p;</span><br><span class="line">    ans = (ans + pow * fst[i - <span class="number">1</span>] % p * lst[i + <span class="number">1</span>]) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(ans * <span class="built_in">inv</span>(fst[n], p) % p);</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="http://kobicgend.top">小明同學</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章連結:</span> <span class="post-copyright-info"><a href="http://kobicgend.top/posts/d742f422.html">http://kobicgend.top/posts/d742f422.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版權聲明:</span> <span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 授權協議。轉載請註明來源 <a href="http://kobicgend.top" target="_blank">小明の雜貨屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ACM/">ACM</a><a class="post-meta__tags" href="/tags/%E7%AD%86%E8%A8%98/">筆記</a><a class="post-meta__tags" href="/tags/%E6%95%B8%E5%AD%B8/">數學</a><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/25fd10e7.html" title="XCPC wiki - Python"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">XCPC wiki - Python</div></div><div class="info-2"><div class="info-item-1">2024 牛客多校 9I - Interesting Numbers [[…/contests/2024 牛客多校 /2024-08-13：2024 牛客暑期多校训练营 9|2024-08-13：2024 牛客暑期多校训练营 9]] 1234567891011121314151617181920import mathn = int(input())l, r = map(int, input().split())def slove(k) : wei = 10 ** (n // 2) half1 = k // wei half2 = k % wei half3 = 10 ** (n // 2) sqr1 = math.isqrt(half1) sqr2 = math.isqrt(half2) sqr3 = math.isqrt(half3) if sqr3 * sqr3 == half3: sqr3 -= 1 if half1 == sqr1 ** 2: return sqr1 * (sqr3...</div></div></div></a><a class="pagination-related" href="/posts/935ec80a.html" title="XCPC wiki - 区间信息"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">XCPC wiki - 区间信息</div></div><div class="info-2"><div class="info-item-1">ST Table ST 表 (Sparse Table, 稀疏表) 基于 倍增 思想，用于解决 可重复贡献问题 $^\dagger$，支持在 $\Theta(1)$ 的时间内 区间查询，不支持在线修改。 递推计算所有长度为 $2$ 的幂的区间的结果。对于询问 $[\mathscr{l}, r)$，记 $k = \lfloor \log_2(r - \mathscr{l}) \rfloor$，结果为 $[\mathscr{l}, \mathscr{l} + 2^k)$ 和 $[r - 2^k, r)$ 的结果的并。 $^\dagger:$ 区间询问对应的运算符 $$ 满足 $xx=x$ 和结合律 $(xy)z=x(yz)$ ，如 $\max,\ \min,\ |\ ,\ &amp;,\ \gcd$ 等，包括 RMQ (Range Maximum/Minimum Query) 问题和区间 GCD。 标准 RMQ，复杂度 $\Theta(n \log \log n) -...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相關推薦</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/366bb2f2.html" title="【组合计数杂谈】三道 Bingo 游戏题（备份）"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-01</div><div class="info-item-2">【组合计数杂谈】三道 Bingo 游戏题（备份）</div></div><div class="info-2"><div class="info-item-1">本文涉及的知识点：组合数公式，古典概型，Min-Max 反演及推广，卷积优化思想，状态压缩思想与状态压缩 DP，快速数论变换 NTT，快速数论变换 NTT，快速沃尔什变换 FWT。 本系列教程「以题带讲」，以典型题目为载体，着重讲解知识点的适用条件和使用方法，而规避复杂的理论推导。 我不擅长数学，对 CF 和区域赛的数学题，从简单计算到数论组合都望而却步。「tag 是数学吗那不做了。」 可能是因为网上的教程大多是罗列定理，给出大段证明，最后放几个例题链接。我没有耐心和能力读完整篇文章。 2024 ICPC World Finals Astana B. Bingo for the Win! Bingo 游戏，$n$ 个人每人要抢 $k$ 个数，主持人按随机顺序依次报数，报到每个数 $[1,10^{9}]$ 的概率相同。已知如果有多名选手要抢某个数字，那么编号小的选手总是优先抢到。问每个人成为最后一名（其他人都抢完了但自己还没抢完）的概率。 ...</div></div></div></a><a class="pagination-related" href="/posts/ba204004.html" title="Educational Codeforces Round 173 A - E"><img class="cover" src="/img/posts/acm/codeforces-cover.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-21</div><div class="info-item-2">Educational Codeforces Round 173 A - E</div></div><div class="info-2"><div class="info-item-1">2043A - Coin Transformation 按题意模拟。 12345678910111213141516171819202122#include &lt;bits/stdc++.h&gt;using namespace std;using ll = long long;int main() &#123; int t; cin &gt;&gt; t; while (t--) &#123; ll x; cin &gt;&gt; x; ll ans = 1; while (x &gt; 3) &#123; x /= 4; ans &lt;&lt;= 1; &#125; cout &lt;&lt; ans &lt;&lt; endl; &#125; return 0;&#125; 2043B - Digits（分类） 写 $n!$ 次数字 $d$。所以，他得到了数字 $dddddd…ddd$（$n!$ 位...</div></div></div></a><a class="pagination-related" href="/posts/43a1bd89.html" title="樹上問題 - 樹形 DP"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-08</div><div class="info-item-2">樹上問題 - 樹形 DP</div></div><div class="info-2"><div class="info-item-1">Tree 1234567891011121314151617181920212223242526272829303132333435363738struct node &#123; string data; int l, r;&#125;t[10005];void pretvs(int k) &#123; // 先序遍历：先遍历根节点，然后遍历左节点，最后遍历右节点 if (k == 0)return; cout &lt;&lt; t[k].data; if (t[k].l != 0) pretvs(t[k].l); if (t[k].r != 0) pretvs(t[k].r);&#125;void intvs(int k) &#123;// 中序遍历：先遍历左节点，然后遍历根节点，最后遍历右节点（大概可以理解为把树平面投影至二维从左到右） if (k == 0)return; if (t[k].l != 0) intvs(t[k].l); cout &lt;&lt; t[k].data; if (t[k].r !=...</div></div></div></a><a class="pagination-related" href="/posts/6370b5c4.html" title="Educational Codeforces Round 175 (Rated for Div. 2) A-E"><img class="cover" src="/img/posts/acm/codeforces-cover.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-28</div><div class="info-item-2">Educational Codeforces Round 175 (Rated for Div. 2) A-E</div></div><div class="info-2"><div class="info-item-1">2070A. FizzBuzz Remixed 12345678910111213141516#include &lt;bits/stdc++.h&gt;using namespace std;int main() &#123; int J; cin &gt;&gt; J; while (J--) &#123; int n; cin &gt;&gt; n; cout &lt;&lt; (n / 15 * 3 + min(n % 15, 2) + 1) &lt;&lt; endl; &#125; return 0;&#125; 2070B - Robot Program 仔细审题 题解 分为两部分考虑，从起点走到 0，从 0 下一次走到 0。 ...</div></div></div></a><a class="pagination-related" href="/posts/f9a46751.html" title="Codeforces Round 982 (Div. 2)"><img class="cover" src="/img/posts/acm/codeforces-cover.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-27</div><div class="info-item-2">Codeforces Round 982 (Div. 2)</div></div><div class="info-2"><div class="info-item-1">A. Rectangle Arrangement 取最大值的正确性：凸阶梯形平移后即是矩形，其周长与矩形周长相等。 123456789101112131415161718192021222324252627#include &lt;bits/stdc++.h&gt;using namespace std;using ll = long long;int main() &#123; ios::sync_with_stdio(false); cin.tie(nullptr); int t; cin &gt;&gt; t; while (t--) &#123; int n; cin &gt;&gt; n; int X = 0, Y = 0; while (n--) &#123; int x, y; cin &gt;&gt; x &gt;&gt; y; X = max(X, x); Y = max(Y, y); ...</div></div></div></a><a class="pagination-related" href="/posts/ec4161c0.html" title="Codeforces Round 1008 (Div. 1) A - C"><img class="cover" src="/img/posts/acm/codeforces-cover.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-11</div><div class="info-item-2">Codeforces Round 1008 (Div. 1) A - C</div></div><div class="info-2"><div class="info-item-1">2077A/2078C - Breach of Faith 取较大的 $\cfrac{n}{2}+1$ 个放在奇数位，较小的放在偶数位。 12345678910111213141516171819202122232425262728293031323334353637#include &lt;bits/stdc++.h&gt;using namespace std;using ll = long long;int main() &#123; int J; cin &gt;&gt; J; while (J--) &#123; int n; cin &gt;&gt; n; vector&lt;int&gt; a(n * 2); for (int i = 0; i &lt; n * 2; i++) &#123; cin &gt;&gt; a[i]; &#125; sort(a.begin(), a.end()); vector&lt;ll&gt;...</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>評論</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">小明同學</div><div class="author-info-description">「一直游到海水變藍。」</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">382</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">23</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kobicgend"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">用於備份小明的腦子。<br>———— <b>Tips</b> ————<br>部分評論從QQ空間或puq抓取，由於技術有限，無法顯示正確的位置和時間，望見諒。<br>———— <b>本站常規欄目</b> ————<br>周日中午:高中回憶《中外历史纲要》<br>周二清晨:語錄體《主机註記》<br>周三下午:有事大家谈/掷地有声<br>周三/六晚上:算法學習筆記<br>———— <b>計劃中</b> ————<br>美食評測, 每日一圖, ...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">素数筛 （欧拉筛）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6D-%20%E5%8F%88%E8%A7%81%20GCD"><span class="toc-text">VJwin6D - 又见 GCD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A8%E6%95%B0%E8%B7%9D%E7%A6%BB"><span class="toc-text">质数距离</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-text">Description</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F"><span class="toc-text">输入格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="toc-text">输出格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%8C%83%E5%9B%B4"><span class="toc-text">数据范围</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notes"><span class="toc-text">Notes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin14F-%20%E7%BB%88%E4%BA%8E%E7%BB%93%E6%9D%9F%E7%9A%84%E8%B5%B7%E7%82%B9"><span class="toc-text">VJwin14F - 终于结束的起点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">勒让德定理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6H-%20%E9%98%B6%E4%B9%98%E4%B9%8B%E4%B9%98"><span class="toc-text">VJwin6H - 阶乘之乘</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">质因数分解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BUC1B-%20%E4%B8%89%E8%A7%92%E5%BD%A2%E6%95%B0"><span class="toc-text">BUC1B 三角形数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">枚举一个数的约数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6J-Sumdiv"><span class="toc-text">VJwin6J - Sumdiv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1%20-8007-cats-%20%E7%9A%84%20-k-xor"><span class="toc-text">2024 杭电多校 8007 - cats 的 k-xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6F-Revenge-of-GCD"><span class="toc-text">VJwin6F - Revenge of GCD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6E-GCD-Arrays"><span class="toc-text">VJwin6E - GCD Arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin14B-Hankson-%20%E7%9A%84%E8%B6%A3%E5%91%B3%E9%A2%98"><span class="toc-text">VJwin14B - Hankson 的趣味题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CF919C-Partitioning-the-Array"><span class="toc-text">CF919C. Partitioning the Array</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CF921B-A-Balanced-Problemset"><span class="toc-text">CF921B. A Balanced Problemset</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">枚举 1 ~ N 每个数的约数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">枚举 L ~ R 每个数的约数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%20-8E-Haitang-and-Math"><span class="toc-text">2024 牛客多校 8E - Haitang and Math</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E7%B4%A0%E6%95%B0"><span class="toc-text">反素数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-2"><span class="toc-text">Description</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F%20-2"><span class="toc-text">输入格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%20-2"><span class="toc-text">输出格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%8C%83%E5%9B%B4%20-2"><span class="toc-text">数据范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A0%B7%E4%BE%8B%EF%BC%9A"><span class="toc-text">输入样例：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B%EF%BC%9A"><span class="toc-text">输出样例：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notes-2"><span class="toc-text">Notes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%99%E6%95%B0%E4%B9%8B%E5%92%8C"><span class="toc-text">余数之和</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-3"><span class="toc-text">Description</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F%20-3"><span class="toc-text">输入格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%20-3"><span class="toc-text">输出格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%8C%83%E5%9B%B4%20-3"><span class="toc-text">数据范围</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notes-3"><span class="toc-text">Notes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E6%98%8E%E5%8D%95%E8%B0%83%E6%80%A7"><span class="toc-text">证明单调性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E6%98%8E%E8%AF%A5%E5%BC%8F%E5%AD%90%E6%9C%80%E5%A4%9A%E5%8F%AA%E6%9C%89%20-2-sqrt-k-%20%E4%B8%AA%E5%8F%96%E5%80%BC"><span class="toc-text">证明该式子最多只有 $2\sqrt{k}$ 个取值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5%E4%B8%8B%E7%95%8C%E6%B1%82%E4%B8%8A%E7%95%8C"><span class="toc-text">已知下界求上界</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95"><span class="toc-text">算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Codes"><span class="toc-text">Codes</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">最大公约数（gcd）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6G-GCD-Table"><span class="toc-text">VJwin6G - GCD Table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6B-gcd"><span class="toc-text">VJwin6B - gcd.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin6C-GCD-LCM"><span class="toc-text">VJwin6C - GCD LCM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin13D-%20%E5%B0%8F%E9%81%93%E6%B6%88%E6%81%AF"><span class="toc-text">VJwin13D - 小道消息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin15B-%20%E6%B7%BB%E5%8A%A0%E6%8B%AC%E5%8F%B7%20III%EF%BC%88%E8%B4%AA%E5%BF%83%EF%BC%89"><span class="toc-text">VJwin15B - 添加括号 III（贪心）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%20-4H-Yet-Another-Origami-Problem%EF%BC%88%E6%80%9D%E7%BB%B4%EF%BC%89"><span class="toc-text">2024 牛客多校 4H - Yet Another Origami Problem（思维）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%20-8A-Haitang-and-Game%EF%BC%88%E6%80%9D%E7%BB%B4%EF%BC%89"><span class="toc-text">2024 牛客多校 8A - Haitang and Game（思维）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%20-10F-Collinear-Exception"><span class="toc-text">2024 牛客多校 10F. Collinear Exception</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">互质与欧拉函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">暴力枚举 lcm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">同余</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%20%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%20-3B-Crash-Test"><span class="toc-text">2024 牛客多校 3B - Crash Test</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CF1994D-Funny-Game"><span class="toc-text">CF1994D. Funny Game</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">数论倒数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VJwin13I-%20%E6%A8%A1%E6%84%8F%E4%B9%89%E4%B8%8B%E7%9A%84%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83%20-2"><span class="toc-text">VJwin13I - 模意义下的乘法逆元 2</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/abe0ec5b.html" title="Map"><img src="/img/posts/music/monochrome_sense.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Map"></a><div class="content"><a class="title" href="/posts/abe0ec5b.html" title="Map">Map</a><time datetime="2026-02-13T16:00:00.000Z" title="更新於 2026-02-14 00:00:00">2026-02-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/31f676fd.html" title="〔主机註記〕第 105 周主机註記 (Feb.9 - Feb.15)"><img src="/img/zhuji-cover.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="〔主机註記〕第 105 周主机註記 (Feb.9 - Feb.15)"></a><div class="content"><a class="title" href="/posts/31f676fd.html" title="〔主机註記〕第 105 周主机註記 (Feb.9 - Feb.15)">〔主机註記〕第 105 周主机註記 (Feb.9 - Feb.15)</a><time datetime="2026-02-09T22:30:00.000Z" title="更新於 2026-02-10 06:30:00">2026-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9c43eea3.html" title="〔主机註記〕第 104 周主机註記 (Feb.2 - Feb.8)"><img src="/img/zhuji-cover.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="〔主机註記〕第 104 周主机註記 (Feb.2 - Feb.8)"></a><div class="content"><a class="title" href="/posts/9c43eea3.html" title="〔主机註記〕第 104 周主机註記 (Feb.2 - Feb.8)">〔主机註記〕第 104 周主机註記 (Feb.2 - Feb.8)</a><time datetime="2026-02-02T22:30:00.000Z" title="更新於 2026-02-03 06:30:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/449a65b8.html" title="〔主机註記〕第 103 周主机註記 (Janu.26 - Feb.1)"><img src="/img/zhuji-cover.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="〔主机註記〕第 103 周主机註記 (Janu.26 - Feb.1)"></a><div class="content"><a class="title" href="/posts/449a65b8.html" title="〔主机註記〕第 103 周主机註記 (Janu.26 - Feb.1)">〔主机註記〕第 103 周主机註記 (Janu.26 - Feb.1)</a><time datetime="2026-01-26T22:30:00.000Z" title="更新於 2026-01-27 06:30:00">2026-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7cd85ddd.html" title="〔主机註記〕第 102 周主机註記 (Janu.19 - Janu.25)"><img src="/img/zhuji-cover.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="〔主机註記〕第 102 周主机註記 (Janu.19 - Janu.25)"></a><div class="content"><a class="title" href="/posts/7cd85ddd.html" title="〔主机註記〕第 102 周主机註記 (Janu.19 - Janu.25)">〔主机註記〕第 102 周主机註記 (Janu.19 - Janu.25)</a><time datetime="2026-01-19T22:30:00.000Z" title="更新於 2026-01-20 06:30:00">2026-01-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2026 By 小明同學</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{const t=()=>{if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typesetPromise();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"none"},chtml:{scale:1.1},options:{enableMenu:!0,renderActions:{findScript:[10,t=>{for(const e of document.querySelectorAll('script[type^="math/tex"]')){const n=!!e.type.match(/; *mode=display/),a=new t.options.MathItem(e.textContent,t.inputJax[0],n),d=document.createTextNode("");e.parentNode.replaceChild(d,e),a.start={node:d,delim:"",n:0},a.end={node:d,delim:"",n:0},t.math.push(a)}},""]}}};const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js",t.id="MathJax-script",t.async=!0,document.head.appendChild(t)}};btf.addGlobalFn("encrypt",t,"mathjax"),window.pjax?t():window.addEventListener("load",t)})()</script><script>(()=>{const o="shuoshuo"===GLOBAL_CONFIG_SITE.pageType,t=null,e=(e=document,n=location.pathname)=>{twikoo.init({el:e.querySelector("#twikoo-wrap"),envId:"https://twikoo.kobicgend.top/",region:"ap-shanghai",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))},...t,path:n}),o&&(window.shuoshuoComment.destroyTwikoo=()=>{e.children.length&&(e.innerHTML="",e.classList.add("no-comment"))})},n=(o,t)=>{"object"==typeof twikoo?setTimeout(()=>e(o,t),0):btf.getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>e(o,t))};o?window.shuoshuoComment={loadComment:n}:n()})()</script></div><script src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script src="/js/flipcountdown.js"></script><script data-pjax src="/js/runtime.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script></body></html>